{"queue": [], "error": "Command '['osascript', '-e', '\\n        tell application \"Music\"\\n            try\\n                if not (exists current track) then return \"STOPPED\"\\n                \\n                set curTrack to current track\\n                set curName to name of curTrack\\n                set curId to id of curTrack\\n                \\n                -- Try to find which playlist we are actually playing from\\n                set targetPlaylist to missing value\\n                \\n                -- Priority 1: Check if \"current playlist\" works (standard for local files)\\n                try\\n                    set p to current playlist\\n                    if (exists track 1 of p) then\\n                        set targetPlaylist to p\\n                    end if\\n                end try\\n                \\n                -- Priority 2: Search for the track ID in specific playback containers\\n                if targetPlaylist is missing value then\\n                    try\\n                        set allPlaylists to playlists\\n                        repeat with p in allPlaylists\\n                            try\\n                                -- We check for track matching ID and being in a \\'playing\\' context\\n                                -- This is heuristic but often works for Apple Music streams\\n                                if (exists (track 1 of p whose id is curId)) then\\n                                    set targetPlaylist to p\\n                                    exit repeat\\n                                end if\\n                            end try\\n                        end repeat\\n                    end try\\n                end if\\n                \\n                -- Priority 3: Fallback to Library if nothing else found\\n                if targetPlaylist is missing value then\\n                    set targetPlaylist to library playlist 1\\n                end if\\n                \\n                -- Now get indices\\n                set curIdx to 0\\n                try\\n                    -- Try to find the specific index in the chosen playlist\\n                    set tList to tracks of targetPlaylist\\n                    repeat with i from 1 to count tList\\n                        if id of (item i of tList) is curId then\\n                            set curIdx to i\\n                            exit repeat\\n                        end if\\n                    end repeat\\n                end try\\n                \\n                if curIdx is 0 then return \"EMPTY\"\\n                \\n                set totalCount to count tracks of targetPlaylist\\n                set stopIdx to curIdx + 50\\n                if stopIdx > totalCount then set stopIdx to totalCount\\n                \\n                set results to {}\\n                if curIdx < totalCount then\\n                    repeat with i from (curIdx + 1) to stopIdx\\n                        try\\n                            set t to track i of targetPlaylist\\n                            set end of results to (name of t & \"|\" & artist of t & \"|\" & album of t)\\n                        end try\\n                    end repeat\\n                end if\\n                \\n                if (count results) is 0 then return \"EMPTY\"\\n                \\n                set AppleScript\\'s text item delimiters to \"!!\"\\n                return results as string\\n            on error errMsg\\n                return \"ERROR|\" & errMsg\\n            end try\\n        end tell\\n        ']' timed out after 10 seconds"}
